/*
 * datetime: a jQuery plugin, version: 0.9.0 (2011-05-13)
 * @requires jQuery v1.2.3 or later
 *
 * Datetime is a jQuery plugin that makes it easy to support automatically
 * updating timestamps (e.g. "4 minutes ago", "12:05am", or "Tuesday at 5:02pm").
 *
 * For usage and examples, visit:
 * http://github.com/carter-thaxton/jquery.datetime
 *
 * Inspired by jquery.timeago, by Ryan McGeary.
 * Enhanced to support date formats more appropriate for a local business,
 * especially one that may have night-time business hours beyond midnight.
 *
 * Licensed under the MIT:
 * http://www.opensource.org/licenses/mit-license.php
 *
 * Copyright (c) 2011, Carter Thaxton (carter.thaxton -[at]- gmail [*dot*] com)
 */(function(a){function e(a){return b.inWords(a)}function d(c){c=a(c);if(!c.data("datetime")){c.data("datetime",{datetime:b.extract(c)});var d=a.trim(c.text());d.length>0&&c.attr("title",d)}return c.data("datetime")}function c(){var b=d(this);isNaN(b.datetime)||a(this).text(e(b.datetime));return this}a.datetime=function(b){return b instanceof Date?e(b):typeof b=="string"?e(a.datetime.parse(b)):e(a.datetime.extract(b))};var b=a.datetime;a.extend(b,{settings:{refreshMillis:6e4,allowFuture:!0,relativeLimitMinutes:20,businessDateRolloverHour:4,useShortDateNames:!1,strings:{prefixAgo:null,prefixFromNow:null,suffixAgo:"ago",suffixFromNow:"from now",seconds:"less than a minute",minute:"about a minute",minutes:"%d minutes",hour:"about an hour",hours:"about %d hours",day:"a day",days:"%d days",month:"about a month",months:"%d months",year:"about a year",years:"%d years",time:"%h12:%min%ampm",today:"at %time",thisWeek:"on %day at %time",thisYear:"on %day, %month %date",future:"on %day, %month %date, %year",other:"on %day, %month %date, %year",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],shortDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],shortMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],numberNames:[]}},inWords:function(b){function l(a){var b=new Date(a);b.setHours(0,0,0,0),c.businessDateRolloverHour&&a.getHours()<c.businessDateRolloverHour&&b.setDate(b.getDate()-1);return b}function k(b,c,d,e,f,g,i){var j=a.isFunction(b)?b(c):b;j=j.replace(/%sec/i,h(d,2)).replace(/%min/i,h(e,2)).replace(/%hour/i,f).replace(/%h12/i,g).replace(/%ampm/i,i);return j}function j(b,c,d,e,f,g,h){var i=a.isFunction(b)?b(c):b;i=i.replace(/%time/i,d).replace(/%day/i,e).replace(/%date/i,f).replace(/%month/i,g).replace(/%year/i,h);return i}function i(c,e){var f=a.isFunction(c)?c(e,b):c,g=d.numberNames&&d.numberNames[e]||e;return f.replace(/%d/i,g)}function h(a,b){var c=String(a);while(c.length<b)c="0"+c;return c}var c=this.settings,d=c.strings,e=d.prefixAgo,f=d.suffixAgo,g=new Date,m=g.getTime()-b.getTime();this.settings.allowFuture&&(m<0&&(e=d.prefixFromNow,f=d.suffixFromNow),m=Math.abs(m));var n=m/1e3,o=n/60,p=o/60,q=p/24,r=q/365,s,t=m>=0&&c.relativeLimitMinutes&&o<=c.relativeLimitMinutes;if(t){var u=n<45&&i(d.seconds,Math.round(n))||n<90&&i(d.minute,1)||o<45&&i(d.minutes,Math.round(o))||o<90&&i(d.hour,1)||p<24&&i(d.hours,Math.round(p))||p<48&&i(d.day,1)||q<30&&i(d.days,Math.floor(q))||q<60&&i(d.month,1)||q<365&&i(d.months,Math.floor(q/30))||r<2&&i(d.year,1)||i(d.years,Math.floor(r));s=a.trim([e,u,f].join(" "))}else{var v=b.getSeconds(),w=b.getMinutes(),x=b.getHours(),y=x>12?x-12:x==0?12:x,z=x>=12?"pm":"am",A=k(d.time,b,v,w,x,y,z),B=l(b),C=l(g),D=c.useShortDateNames?d.shortDayNames:d.dayNames,E=c.useShortDateNames?d.shortMonthNames:d.monthNames,F=D[B.getDay()],G=B.getDate(),H=E[B.getMonth()],I=B.getFullYear(),J=864e5,K;B.getTime()===C.getTime()?K=d.today:B.getTime()>C.getTime()?K=d.future:B.getTime()>=C.getTime()-6*J?K=d.thisWeek:B.getFullYear()==C.getFullYear()?K=d.thisYear:K=d.other,s=j(K,b,A,F,G,H,I)}return s},parse:function(b){var c=a.trim(b);c=c.replace(/\.\d\d\d+/,""),c=c.replace(/-/,"/").replace(/-/,"/"),c=c.replace(/T/," ").replace(/Z/," UTC"),c=c.replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2");return new Date(c)},extract:function(c){var d=a(c).get(0).tagName.toLowerCase()==="time",e=d?a(c).attr("datetime"):a(c).attr("title");return b.parse(e)}}),a.fn.datetime=function(){var a=this;a.each(c);var d=b.settings;d.refreshMillis>0&&setInterval(function(){a.each(c)},d.refreshMillis);return a},document.createElement("abbr"),document.createElement("time")})(jQuery)